!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="32c1b2ed-b6e2-42b4-ab54-f56f732ad8a5",e._sentryDebugIdIdentifier="sentry-dbid-32c1b2ed-b6e2-42b4-ab54-f56f732ad8a5")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405,189],{48312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(23574)}])},81444:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(85893);n(67294);var l=n(56342),o=e=>{let{children:t}=e;return(0,i.jsx)(l.SV,{beforeCapture:e=>{e.setTag("location","SentryErrorBoundary")},children:t})}},23574:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return en},default:function(){return et}});var i=n(85893),l=n(9008),o=n.n(l),a=n(15202),s=n.n(a),d=n(67294),r=n(81366),u=n(63702),c=n(10513),v=n(60201),p=n(25834),h=n(70498),m=n(55799),E=n(71397),f=n(79977),b=n(39507),S=n(900),C=n(46503),T=n(19084),g=n(6812),_=n(50319),D=n(33941),I=n(19916),x=n(89884),w=n(81940),A=n(15555),y=n(90797);let N=e=>{let{appointmentId:t,customerPortalParentUrl:n,jobId:i,newEnd:l,newStart:o,oldStart:a}=e;window.parent.postMessage({appointmentId:parseInt(t,10),jobId:parseInt(i,10),newEnd:l,newStart:o,oldStart:a,type:y.eG.APPOINTMENT_RESCHEDULED},n)},j=e=>{let{customerPortalParentUrl:t,jobId:n}=e;window.parent.postMessage({jobId:parseInt(n,10),type:y.eG.RESCHEDULE_CLOSED},t)},L=e=>{let{customerPortalParentUrl:t,error:n,errorCode:i,jobId:l}=e;window.parent.postMessage({error:n,errorCode:i,jobId:parseInt(l,10),type:y.eG.RESCHEDULE_ERROR},t)};var O=n(93321),M=n(82694),P=e=>{var t,n,l,o;let{onClose:a}=e,[s]=(0,c.m)(),{getPhrase:r}=(0,T.hO)(),{inMemory:{appointmentCancelOrRescheduleContext:u}}=s,[y,P]=(0,d.useState)(void 0),[k,R]=(0,d.useState)(!1),Z=(null==u?void 0:u.timezone)||"UTC",U="en-US",z=null==u?void 0:u.customerPortalParentUrl,F=null==u?void 0:null===(t=u.appointment)||void 0===t?void 0:t.jobId,{initEndDate:H,initMonthYear:B,initStartDate:G}=(0,d.useMemo)(()=>{let e=new Date,t=(0,w.ag)(e,Z),n=new Date(Date.UTC(e.getFullYear(),e.getMonth()));return{initEndDate:t.toISOString(),initMonthYear:(0,x.zW)(n,Z).toISOString(),initStartDate:e.toISOString()}},[Z]),[V,Y]=(0,d.useState)({endDate:H,startDate:G}),W=(0,d.useMemo)(()=>({input:function(e,t,n){var i,l;if(!e)return{customerId:void 0,endDate:n,isNewCustomer:!1,isNewLocation:!1,issueCategory:O.qE.HVAC,issuePath:"",jobTypeId:"",locationId:void 0,serviceZoneId:"",startDate:t};let{customer:o,jobTypeId:a,location:s,selectedIssues:d,tradeType:r,zoneId:u}=e,c=null==d?void 0:d.map(e=>e.id).join("/");return{customerId:null==o?void 0:o.id,endDate:n,isNewCustomer:null!==(i=null==o?void 0:o.isNew)&&void 0!==i&&i,isNewLocation:null!==(l=null==s?void 0:s.isNew)&&void 0!==l&&l,issueCategory:r||O.qE.HVAC,issuePath:c||"",jobTypeId:null!=a?a:"",locationId:null==s?void 0:s.id,serviceZoneId:null!=u?u:"",startDate:t}}(u,G,H)}),[u,H,G]),K=null==u?void 0:u.rescheduleToken,{data:q,fetchMore:J,loading:X}=(0,g.aM)(D.NS,{context:K?{headers:{Authorization:"Bearer ".concat(K)}}:void 0,fetchPolicy:"cache-first",notifyOnNetworkStatusChange:!0,onCompleted:e=>{if((null==e?void 0:e.getAvailability.__typename)==="AvailabilityResponse"){let t=e.getAvailability;Y(e=>{var n;return{...e,endDate:null!==(n=t.adjustedEndDate)&&void 0!==n?n:e.endDate}})}},skip:!(null==u?void 0:u.selectedIssues)||!(null==u?void 0:u.zoneId)||!K,variables:W}),[Q,{loading:$}]=(0,_.D)(I.nB,{context:K?{headers:{Authorization:"Bearer ".concat(K)}}:void 0,onCompleted:e=>{(null==e?void 0:e.rescheduleAppointment.__typename)==="RescheduleAppointmentOutput"?(z&&F&&y&&(null==u?void 0:u.appointment)&&N({appointmentId:u.appointment.id,customerPortalParentUrl:z,jobId:F,newEnd:y.endDate,newStart:y.startDate,oldStart:u.appointment.start}),a()):(null==e?void 0:e.rescheduleAppointment.__typename)==="ErrorResponse"&&z&&F&&L({customerPortalParentUrl:z,error:e.rescheduleAppointment.message,jobId:F})},onError:e=>{if(z&&F){var t,n,i;L({customerPortalParentUrl:z,error:e.message,errorCode:null===(i=e.graphQLErrors)||void 0===i?void 0:null===(n=i[0])||void 0===n?void 0:null===(t=n.extensions)||void 0===t?void 0:t.code,jobId:F})}}}),ee=(null==q?void 0:q.getAvailability.__typename)==="AvailabilityResponse"?q.getAvailability:void 0,et=(0,d.useMemo)(()=>{var e;if(!ee||X)return null;let t=null==u?void 0:u.useNaiveTimezone;return(null!==(e=null==ee?void 0:ee.timeslots)&&void 0!==e?e:[]).filter(e=>e.hasAvailability&&(!t||(0,x.$0)(new Date(e.startDate),Z)>=new Date))},[ee,X,null==u?void 0:u.useNaiveTimezone,Z]),en=(0,d.useCallback)(e=>{if(V.endDate<e.monthYear){let e=new Date(V.endDate),t=(0,w.ag)(new Date(e.getFullYear(),e.getMonth()+1),Z);Y({endDate:t.toISOString(),startDate:e.toISOString()}),J({variables:{input:{...W.input,endDate:t.toISOString(),startDate:e.toISOString()}}})}},[V.endDate,Z,J,W.input]),ei=(0,d.useMemo)(()=>({allAppointments:r("TIME_SLOT_SELECT.TYPE_TOGGLE.ALL_APPOINTMENTS"),firstAvailable:r("TIME_SLOT_SELECT.TYPE_TOGGLE.FIRST_AVAILABLE"),firstAvailableList:r("TIME_SLOT_SELECT.TIME_SLOT_LIST.FIRST_AVAILABLE")}),[r]),el=(0,d.useMemo)(()=>{var e;let t=null==u?void 0:null===(e=u.dispatchFeeAmount)||void 0===e?void 0:e.en;if(!t)return;let n=Number(t);return isNaN(n)?void 0:n},[null==u?void 0:null===(n=u.dispatchFeeAmount)||void 0===n?void 0:n.en]),eo=(0,d.useMemo)(()=>(function(e){if(null==e?void 0:e.address)return{city:e.address.city||"",state:e.address.state||"",zip:e.address.zip||""}})(null==u?void 0:u.location),[null==u?void 0:u.location]),ea=(0,d.useMemo)(()=>{var e,t;return null!==(t=null==(e=null==u?void 0:u.selectedIssues)?void 0:e.slice(1).map(e=>e.label||""))&&void 0!==t?t:[]},[null==u?void 0:u.selectedIssues]),es=(0,d.useMemo)(()=>eo?(0,A.T)(eo,!1):"",[eo]),ed=(0,d.useCallback)(()=>{},[]),er=(0,d.useCallback)(e=>{P(e)},[]),eu=(0,d.useCallback)(()=>{R(!0)},[]),ec=(0,d.useCallback)(()=>{R(!1)},[]),ev=(0,d.useCallback)(()=>{y&&Q({variables:{input:{displayEndDate:y.displayEndDate,displayStartDate:y.displayStartDate,end:y.endDate,start:y.startDate}}})},[y,Q]),ep=(0,d.useCallback)(()=>{z&&F&&j({customerPortalParentUrl:z,jobId:F}),a()},[z,F,a]);if(!u||u.cancelOnly)return null;let{brandName:eh,headerOptions:em,schedulerTitle:eE,tradeType:ef}=u,{backgroundColor:eb,logoUrl:eS,showText:eC}=em||{},eT=function(e){let t=null==e?void 0:e.appointment;if((null==t?void 0:t.end)&&(null==t?void 0:t.start))return{displayEndDate:t.arrivalWindowEnd,displayStartDate:t.arrivalWindowStart,endDate:t.end,startDate:t.start}}(u);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.Z,{backgroundColor:eb,brandName:eh||"",hideCloseButton:!1,logoUrl:eS,onClose:ep,schedulerTitle:r("APPOINTMENT_RESCHEDULE_OR_CANCEL.TITLE"),showText:eC}),(0,i.jsx)(S.P,{active:$||X,children:(0,i.jsxs)(m.x,{children:[eo&&es&&(0,i.jsx)(b.Z,{formattedLocation:es}),(0,i.jsx)(C.p,{children:(0,i.jsx)(E.Z,{headerText:(null==eE?void 0:eE.en)||"",locale:U,location:eo,needDivider:!0,onJobEdit:ed,selectedOptions:ea,timeslot:eT,timeZone:Z,tradeType:ef})}),(0,i.jsx)(f.Z,{availableTimeSlots:et,defaultDispatchFee:el,firstAvailableEnabled:null!==(o=null==u?void 0:u.firstAvailableEnabled)&&void 0!==o&&o,initialMonthYear:B,isEditing:!1,isLoading:X,locale:U,onClickTimeSlot:er,onViewStateChange:en,phrases:ei,scheduleTitle:(null==u?void 0:null===(l=u.scheduleTitle)||void 0===l?void 0:l.en)||"",selectedTimeSlot:y,setSelectedTimeSlot:P,showTimeZone:!(null==u?void 0:u.useNaiveTimezone),timeZone:Z}),(0,i.jsx)(h.Z,{actions:[(0,i.jsx)(v.z,{color:"negative","data-testid":"cancel-button",disabled:$,fill:"subtle",fullWidth:!0,onClick:eu,outline:!0,children:r("APPOINTMENT_RESCHEDULE_OR_CANCEL.CANCEL_BUTTON")},"cancel-button"),(0,i.jsx)(v.z,{color:"primary","data-testid":"reschedule-button",disabled:!y||$,fill:"solid",fullWidth:!0,loading:$,onClick:ev,children:r("APPOINTMENT_RESCHEDULE_OR_CANCEL.RESCHEDULE_BUTTON")},"reschedule-button")]})]})}),(0,i.jsx)(M.ZP,{handleClose:ec,isOpen:k,onCancelSuccess:a,type:M.wD.CancelAppointment})]})},k=n(98470),R=n(52771);n(84301);var Z=n(93717),U=n(49732);n(40682);var z=n(51591);n(47341);var F=n(41227),H=n(65548);n(26642);var B=n(66902);n(46794),n(44752);var G=n(81444);n(84720),n(44908),n(12128),n(53673);var V=n(24835),Y=n(69272),W=n(91511),K=n(81315),q=n(82729),J=n(41686),X=n(56793);function Q(){let e=(0,q._)(["\n  background-color: white;\n  border-radius: 6px;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  min-height: 640px;\n  width: 100%;\n\n  @media (max-width: ",") {\n    height: 100vh;\n  }\n"]);return Q=function(){return e},e}let $=(0,J.ZP)(Y.K)(Q(),X.tokens.breakpointMobileLarge);var ee=e=>{let{onClose:t}=e;return(0,i.jsxs)($,{direction:"column",justifyContent:"flex-start",spacing:0,children:[(0,i.jsxs)(Y.K,{className:"p-3",direction:"row",justifyContent:"space-between",style:{borderBottom:"1px solid #e0e0e0"},children:[(0,i.jsx)(W.s,{children:"AI Chat Assistant"}),(0,i.jsx)(K.J,{"data-testid":"close-button",name:"close",onClick:t,style:{cursor:"pointer"}})]}),(0,i.jsx)(Y.K,{className:"p-3",direction:"column",style:{flex:1,overflowY:"auto"}})]})};n(34155);var et=e=>{var t;let{abandonedSessionStatus:n,aiChatModeEnabled:l,brandId:a,environment:v,featureFlags:p,initialAppState:h,initialState:m,inlineMode:E,isDemo:f,isRoutingEnabled:b,resolvedValidOrigins:S,schedulerConfigs:C,schedulerId:g,scriptLevel:_,showLinearNavigation:D,userMetadata:I}=e,{handleSetModalVisible:x,modalVisible:w,setModalVisible:A}=(0,B.h)(void 0,{environment:v,pageSource:y.w7.ROOT}),[N,j]=(0,d.useState)(!!h),L=C.find(e=>{let{id:t}=e;return t===g}),M=null!==(t=C.find(e=>{let{isDefault:t,isRoutable:n}=e;return t&&n}))&&void 0!==t?t:C.find(e=>{let{isRoutable:t}=e;return t});return(0,d.useEffect)(()=>{!N&&h&&j(!0)},[x,h,w,N]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o(),{children:[(0,i.jsx)("title",{children:"ServiceTitan: Scheduling Pro"}),(0,i.jsx)("meta",{content:"Scheduling Pro booking",name:"description"}),(0,i.jsx)("meta",{content:"noindex,nofollow",name:"robots"}),(0,i.jsx)("meta",{content:"width=device-width, initial-scale=1",name:"viewport"}),(0,i.jsx)("link",{href:"/favicon.ico",rel:"icon",type:"image/x-icon"})]}),(0,i.jsx)("main",{className:"".concat(s().main),children:(0,i.jsx)(c.Z,{abandonedSessionStatus:n,brandId:a,currentScheduler:L,defaultSchedulerNavSequence:null==M?void 0:M.navSequence,initialAppState:h,initialState:m,isCallCenterScheduler:(null==L?void 0:L.mode)===O.ud.CALL_CENTER,isDemo:f,isRoutingEnabled:b,navigationMode:D?O.vt.LINEAR:(null==L?void 0:L.navigationMode)?L.navigationMode:(null==M?void 0:M.navigationMode)?M.navigationMode:O.vt.CARD,schedulerId:g,children:(0,i.jsx)(k.Z,{children:(0,i.jsx)(F.M,{schedulers:C,children:(0,i.jsxs)(z.n,{schedulerConfigs:C,children:[(0,i.jsx)(U.Z,{}),(0,i.jsx)(Z.ZP,{directLink:!!h,resolvedValidOrigins:S,schedulerContext:C,children:(0,i.jsx)(T.FS,{phrases:R,children:(0,i.jsx)(G.Z,{children:(0,i.jsx)(H.Km,{featureFlags:p,children:(0,i.jsxs)(r.Z,{aiChatModeEnabled:l,inlineMode:E,isDemo:f,modalVisible:w,scriptLevel:_,setModalVisible:x,shouldOpenModalForDirectLink:N,userMetadata:I,children:[w===y.w8.BOOKING&&(0,i.jsx)(u.Z,{onClose:()=>A(void 0)}),w===y.w8.APPOINTMENT_RESCHEDULE_OR_CANCEL&&(0,i.jsx)(P,{onClose:()=>A(void 0)}),w===y.w8.AI_CHAT&&(0,i.jsx)(ee,{onClose:()=>A(void 0)}),void 0===w||w===y.w8.APPOINTMENT_CANCEL&&(0,i.jsx)(V.Z,{onClose:()=>A(void 0)})]})})})})})]})})})})})]})},en=!0},26642:function(e,t,n){"use strict";n(34155).env.ALLOW_LOCALHOST_ORIGINS},47341:function(e,t,n){"use strict";n(97334)},12128:function(e,t,n){"use strict";n(97385)}},function(e){e.O(0,[878,885,481,932,143,765,173,427,915,941,148,118,87,888,774,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);